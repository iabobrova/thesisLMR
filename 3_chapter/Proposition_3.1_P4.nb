(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42153,       1098]
NotebookOptionsPosition[     38404,       1035]
NotebookOutlinePosition[     38799,       1051]
CellTagsIndexPosition[     38756,       1048]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"initial", " ", "functions", " ", 
   RowBox[{"(", 
    RowBox[{"V", ".", "V", ".", " ", "Sokolov"}], ")"}]}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9031581171263847`*^9, 3.903158125801593*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"0a2a61d5-a80b-4c1e-858f-54772ab64b7c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"i___", ",", "j_", ",", "k_", ",", "l___"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"j", "\[NotEqual]", "0"}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{"j", "\[Equal]", 
      RowBox[{"-", "k"}]}], ")"}]}]}], ":=", 
  RowBox[{"u", "[", 
   RowBox[{"i", ",", "l"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"f_", ",", "g_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"f", "/.", 
       RowBox[{"u", "\[Rule]", "lu"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"g", "/.", 
       RowBox[{"u", "\[Rule]", "ru"}]}], ")"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"lu", "[", "l___", "]"}], 
     RowBox[{"ru", "[", "r___", "]"}]}], "\[RuleDelayed]", 
    RowBox[{"u", "[", 
     RowBox[{"l", ",", "r"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M", "[", 
    RowBox[{"f_", ",", "g_", ",", "h__"}], "]"}], ":=", 
   RowBox[{"M", "[", 
    RowBox[{
     RowBox[{"M", "[", 
      RowBox[{"f", ",", "g"}], "]"}], ",", "h"}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"P_", ",", "eq_"}], "]"}], ":=", 
   RowBox[{"P", "/.", 
    RowBox[{
     RowBox[{"u", "[", "m___", "]"}], "\[RuleDelayed]", 
     RowBox[{"du", "[", 
      RowBox[{"eq", ",", "m"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"du", "[", 
    RowBox[{"eq_", ",", "m_", ",", "n___"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"M", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"m", "<", "0"}], ",", 
        RowBox[{"-", 
         RowBox[{"M", "[", 
          RowBox[{
           RowBox[{"u", "[", "m", "]"}], ",", 
           RowBox[{"eq", "[", 
            RowBox[{"-", "m"}], "]"}], ",", 
           RowBox[{"u", "[", "m", "]"}]}], "]"}]}], ",", 
        RowBox[{"eq", "[", "m", "]"}], ",", 
        RowBox[{"eq", "[", "m", "]"}]}], "]"}], ",", 
      RowBox[{"u", "[", "n", "]"}]}], "]"}], "+", 
    RowBox[{"M", "[", 
     RowBox[{
      RowBox[{"u", "[", "m", "]"}], ",", 
      RowBox[{"du", "[", 
       RowBox[{"eq", ",", "n"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"du", "[", "eq_", "]"}], ":=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"vwlist", ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"vlist", ",", "wlist"}], "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"we", "[", "i_", "]"}], ":=", 
   RowBox[{"Switch", "[", 
    RowBox[{"i", ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"Sequence", "@@", "vwlist"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mono", "[", "d_", "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Outer", "[", 
     RowBox[{"u", ",", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{"vlist", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "d"}], "}"}]}], "]"}]}]}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"homo", "[", 
    RowBox[{"mon_", ",", "w_"}], "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{"mon", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{"we", "/@", 
          RowBox[{"(", 
           RowBox[{"uu", "@@", "#"}], ")"}]}], ")"}]}], "\[Equal]", "w"}], 
      "&"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlist", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wlist", "=", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "cycClass0", "]"}], "\n", 
 RowBox[{
  RowBox[{"cycClass0", "[", 
   RowBox[{"u", "[", "]"}], "]"}], ":=", 
  RowBox[{"u", "[", "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cycClass0", "[", "arg_u", "]"}], ":=", 
   RowBox[{
    RowBox[{"cycLlass1", "[", "arg", "]"}], "=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"class", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"RotateLeft", "[", 
             RowBox[{"arg", ",", "k"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "[", "arg", "]"}]}], "}"}]}], "]"}], "]"}]}], 
        ",", "rep"}], "}"}], ",", 
      RowBox[{
       RowBox[{"rep", "=", 
        RowBox[{"First", "[", "class", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"cycLlass1", "[", 
           RowBox[{"class", "[", 
            RowBox[{"[", 
             RowBox[{"k", "+", "1"}], "]"}], "]"}], "]"}], "=", "rep"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{
            RowBox[{"Length", "[", "class", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ";", "rep"}]}], "]"}]}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cycClass0", "[", "arg_", "]"}], ":=", "arg"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"canon", "[", "expr_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ans", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{"MapAll", "[", 
         RowBox[{"cycClass0", ",", 
          RowBox[{"Collect", "[", 
           RowBox[{"expr", ",", 
            RowBox[{"u", "[", "_", "]"}]}], "]"}]}], "]"}], "]"}]}], "}"}], 
     ",", "\n", 
     RowBox[{
      RowBox[{"Clear", "[", "cycLlass1", "]"}], ";", "ans"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8566129009650764`*^9, 3.856612907085287*^9}, {
   3.856676291825311*^9, 3.8566762959124217`*^9}, {3.856676327047948*^9, 
   3.856676327516823*^9}, {3.856681112725793*^9, 3.856681113422964*^9}, {
   3.8567644989594717`*^9, 3.8567645016989117`*^9}, {3.856764533397999*^9, 
   3.8567645357310376`*^9}, {3.868622114918382*^9, 3.8686221159108353`*^9}, {
   3.8686221797121277`*^9, 3.8686221886320086`*^9}, {3.868674026341576*^9, 
   3.8686740265392838`*^9}, {3.8755031428241034`*^9, 3.875503143178978*^9}, 
   3.903153663210373*^9, {3.903153831450424*^9, 3.9031538453437634`*^9}, 
   3.903153913676489*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"f3ea4bdc-d937-4796-9655-ef9c1d4cf11c"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Hamiltonian", " ", 
   SubscriptBox["H", "4"]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.8686740662254324`*^9, 3.868674082806034*^9}, {
  3.869130847900176*^9, 3.869130851396591*^9}, {3.903158138802178*^9, 
  3.9031581438653517`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"dda56fcf-c2a6-49a7-aca3-db7497f171c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"H", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "k3"}], " ", 
     RowBox[{"u", "[", "1", "]"}]}], "+", 
    RowBox[{"k2", " ", 
     RowBox[{"u", "[", "2", "]"}]}], "-", 
    RowBox[{"2", " ", "z", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}], "-", 
    RowBox[{"u", "[", 
     RowBox[{"1", ",", "1", ",", "2"}], "]"}], "+", 
    RowBox[{"u", "[", 
     RowBox[{"1", ",", "2", ",", "2"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8686726573145695`*^9, 3.868672809689506*^9}, {
   3.8691307241303883`*^9, 3.8691307274615035`*^9}, {3.869130774830562*^9, 
   3.8691308099456*^9}, {3.8691884436271086`*^9, 3.8691884902772503`*^9}, {
   3.869188574068813*^9, 3.869188577893397*^9}, {3.903158151178474*^9, 
   3.903158185167473*^9}, 3.9031583452866287`*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"bcb32108-e4cc-44a8-b475-e61782159cb0"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Hamiltonian", " ", "system"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.868674097658236*^9, 3.8686741098914356`*^9}, 
   3.9031581584420443`*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"6ad73000-3869-4a7d-aea1-86afc89e4388"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"eq", "[", "1", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"k2", " ", 
     RowBox[{"u", "[", "]"}]}], "-", 
    RowBox[{"2", " ", "z", " ", 
     RowBox[{"u", "[", "1", "]"}]}], "-", 
    RowBox[{"u", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "+", 
    RowBox[{"u", "[", 
     RowBox[{"1", ",", "2"}], "]"}], "+", 
    RowBox[{"u", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eq", "[", "2", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"k3", " ", 
     RowBox[{"u", "[", "]"}]}], "+", 
    RowBox[{"2", " ", "z", " ", 
     RowBox[{"u", "[", "2", "]"}]}], "+", 
    RowBox[{"u", "[", 
     RowBox[{"1", ",", "2"}], "]"}], "+", 
    RowBox[{"u", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "-", 
    RowBox[{"u", "[", 
     RowBox[{"2", ",", "2"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868672957600646*^9, 3.868673041966493*^9}, {
  3.9031581822130537`*^9, 3.903158190636381*^9}, {3.903158332998898*^9, 
  3.903158339298416*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"63fa9b80-1b94-4301-91a8-114380b1f451"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"trace", " ", 
    SubscriptBox["S", "1"]}], ",", " ", 
   RowBox[{
    RowBox[{"where", " ", 
     SubscriptBox["S", "1"]}], " ", "=", " ", 
    SubscriptBox["H", "4"]}], ",", " ", 
   RowBox[{
   "is", " ", "a", " ", "first", " ", "integral", " ", "of", " ", "the", " ", 
    "Hamiltonian", " ", "system"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.868674116723302*^9, 3.8686741477246504`*^9}, {
  3.868674185413743*^9, 3.8686741944076853`*^9}, {3.903158170369398*^9, 
  3.903158170804076*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"f0291f1b-87b4-4fc9-93f9-e37cdba700d1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"S1", " ", "=", " ", "H"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"canon", "[", 
  RowBox[{"Expand", "[", 
   RowBox[{
    RowBox[{"d", "[", 
     RowBox[{
      RowBox[{"S1", " ", "/.", " ", 
       RowBox[{"z", " ", "\[Rule]", " ", "t"}]}], ",", "eq"}], "]"}], " ", "/.",
     " ", 
    RowBox[{"t", " ", "\[Rule]", " ", "z"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8686731752739773`*^9, 3.8686731762259583`*^9}, {
  3.8687579093124585`*^9, 3.8687579228290977`*^9}, {3.903158176171938*^9, 
  3.903158195551277*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"7e1e2e46-66f8-4df6-8940-7824e3e0dbfd"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.8686731765589457`*^9, 3.8686741503061733`*^9, 3.8686750239678397`*^9, 
   3.8687564360653567`*^9, 3.8687569536666217`*^9, 3.868757253442191*^9, 
   3.8687579232415113`*^9, 3.8687583754184303`*^9, 3.8691181509029865`*^9, 
   3.869118720104156*^9, 3.869119102579959*^9, 3.869119855077402*^9, 
   3.869126171809411*^9, 3.869126375139505*^9, 3.8691268920172987`*^9, 
   3.869130856902114*^9, 3.86918859184486*^9, 3.869190644018729*^9, 
   3.869297318869517*^9, 3.8695455156799736`*^9, 3.870917167337566*^9, 
   3.870917653841933*^9, 3.9031581960500298`*^9, 3.903158315679892*^9, {
   3.903158379219562*^9, 3.903158406170135*^9}},
 CellLabel->"Out[26]=",ExpressionUUID->"4ae1bcad-2f21-4449-ade8-869a1faf2822"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"trace", " ", 
    SubscriptBox["S", "2"]}], ",", " ", 
   RowBox[{
    RowBox[{"where", " ", 
     SubscriptBox["S", "2"]}], " ", "=", " ", 
    SuperscriptBox[
     SubscriptBox["h", "4"], "2"]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.8686741775539675`*^9, 3.8686742085914373`*^9}, {
  3.8691187293636*^9, 3.8691187297466745`*^9}, {3.903158201120227*^9, 
  3.903158201780059*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"8424e404-2b9d-4f51-99e1-c7737976e911"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SS2", " ", "=", " ", 
    RowBox[{
     RowBox[{"a1", " ", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "2", ",", " ", "1"}], 
       "]"}]}], " ", "+", " ", 
     RowBox[{"a2", " ", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1"}], 
       "]"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", " ", "-", " ", "a1", " ", "-", " ", "a2"}], ")"}], " ", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2"}], 
       "]"}]}], " ", "+", " ", 
     RowBox[{"b1", " ", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "2", ",", "1", ",", "2"}], 
       "]"}]}], " ", "+", " ", 
     RowBox[{"b2", " ", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "1", ",", "2", ",", "1", ",", "1", ",", "2"}], 
       "]"}]}], " ", "+", " ", 
     RowBox[{"b3", " ", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "1", ",", "2", ",", "1", ",", "2", ",", "1"}], 
       "]"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "-", " ", "b1", " ", "-", " ", "b2", " ", 
        "-", " ", "b3"}], ")"}], " ", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "2", ",", "2"}], 
       "]"}]}], " ", "+", " ", 
     RowBox[{"c1", " ", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "1", ",", "2", ",", "1", ",", "2", ",", "2"}], 
       "]"}]}], " ", "+", " ", 
     RowBox[{"c2", " ", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "1", ",", "2", ",", "2", ",", "1", ",", "2"}], 
       "]"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", " ", "-", " ", "c1", " ", "-", " ", "c2"}], ")"}], " ", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "2", ",", "2", ",", "2"}], 
       "]"}]}], " ", "+", " ", 
     RowBox[{"d1", " ", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{"k2", " ", "+", " ", "k3"}], ")"}]}], " ", "-", " ", "d1"}],
        ")"}], " ", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "2"}], "]"}]}], " ", "+", " ", 
     RowBox[{"2", " ", "k2", " ", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "1", ",", "2", ",", "2"}], "]"}]}], " ", "+", " ", 
     RowBox[{"2", " ", "k3", " ", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "1"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      SuperscriptBox["k2", "2"], " ", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "2"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      SuperscriptBox["k3", "2"], " ", 
      RowBox[{"u", "[", 
       RowBox[{"1", ",", "1"}], "]"}]}], " ", "-", " ", 
     RowBox[{"2", " ", "k2", " ", "k3", " ", 
      RowBox[{"u", "[", 
       RowBox[{"2", ",", "1"}], "]"}]}], " ", "+", " ", 
     RowBox[{"z", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"e1", " ", 
         RowBox[{"u", "[", 
          RowBox[{"2", ",", "1", ",", "1", ",", "2", ",", "1"}], "]"}]}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", " ", "-", " ", "e1"}], ")"}], " ", 
         RowBox[{"u", "[", 
          RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "2"}], "]"}]}], " ",
         "+", " ", 
        RowBox[{"f1", " ", 
         RowBox[{"u", "[", 
          RowBox[{"2", ",", "1", ",", "2", ",", "1", ",", "2"}], "]"}]}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", " ", "4"}], " ", "-", " ", "f1"}], ")"}], " ", 
         RowBox[{"u", "[", 
          RowBox[{"2", ",", "1", ",", "1", ",", "2", ",", "2"}], "]"}]}], " ",
         "-", " ", 
        RowBox[{"4", " ", "k2", " ", 
         RowBox[{"u", "[", 
          RowBox[{"2", ",", "1", ",", "2"}], "]"}]}], " ", "+", " ", 
        RowBox[{"4", " ", "k3", " ", 
         RowBox[{"u", "[", 
          RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}], " ", "+", 
     " ", 
     RowBox[{
      SuperscriptBox["z", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g1", " ", 
         RowBox[{"u", "[", 
          RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "]"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", " ", "-", " ", "g1"}], ")"}], " ", 
         RowBox[{"u", "[", 
          RowBox[{"2", ",", "1", ",", "1", ",", "2"}], "]"}]}]}], ")"}]}]}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S2", " ", "=", " ", 
   RowBox[{
    RowBox[{"canon", "[", 
     RowBox[{"SS2", " ", "//", " ", "Expand"}], "]"}], " ", "/.", " ", 
    RowBox[{"t", " ", "\[Rule]", " ", "z"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.869118096303257*^9, 3.869118109513219*^9}, 
   3.8691307033870077`*^9, 3.869188521397196*^9, 3.8691906707114706`*^9, {
   3.8695449311352444`*^9, 3.8695452775615687`*^9}, {3.903158212558734*^9, 
   3.903158212918498*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"dc440fc4-555e-424b-9ba9-31172769df75"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"trace", " ", 
   SubscriptBox["S", "2"], " ", "should", " ", "be", " ", "a", " ", "first", 
   " ", "integral", " ", "of", " ", "the", " ", "Hamiltonian", " ", 
   "system"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.8686742327419634`*^9, 3.868674255647453*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"d8d75281-56df-4f85-becd-34a68ebb7560"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"S2cond", " ", "=", " ", 
   RowBox[{"canon", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{
        RowBox[{"S2", " ", "/.", " ", 
         RowBox[{"z", " ", "\[Rule]", " ", "t"}]}], ",", " ", "eq"}], "]"}], 
      " ", "/.", " ", 
      RowBox[{"t", " ", "\[Rule]", " ", "z"}]}], "//", " ", "Expand"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S2condd", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{"S2cond", ",", " ", "z"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS2vars", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "al", ",", "bet", ",", "a1", ",", "a2", ",", "b1", ",", "b2", ",", "b3", 
     ",", "c1", ",", "c2", ",", "e1", ",", "f1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S2vars", " ", "=", " ", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"Variables", "[", "S2condd", "]"}], ",", " ", 
     RowBox[{"Union", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4"}], "}"}],
        ",", " ", "SS2vars"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8687578374854326`*^9, 3.868757863239288*^9}, 
   3.869119886235467*^9, {3.869125952592838*^9, 3.8691259566771984`*^9}, {
   3.903158231058819*^9, 3.903158237584388*^9}, 3.90315839766673*^9},
 CellLabel->"In[31]:=",ExpressionUUID->"e0bae1e6-d102-46b8-a1b4-17bded858e06"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"find", " ", "the", " ", "undefined", " ", "coefficients"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.903158242778596*^9, 3.903158253196458*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"0bee7e23-c418-4976-8a75-6c8178cc8dc1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"varr", "[", "k_", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Variables", "[", "S2vars", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"#", ",", "u"}], "]"}], "\[Equal]", "False"}], "&"}]}], 
     "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "k"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqs", "[", "k_", "]"}], " ", ":=", " ", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"S2condd", ",", 
          RowBox[{
           RowBox[{"varr", "[", "k", "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"varr", "[", "k", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
     ",", 
     RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqvars", "[", "k_", "]"}], " ", ":=", " ", 
  RowBox[{"Variables", "[", 
   RowBox[{"eqs", "[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "[", "k_", "]"}], " ", ":=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"eqs", "[", "k", "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", 
    RowBox[{"eqvars", "[", "k", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8691233951640143`*^9, 3.8691234425063925`*^9}, {
   3.8691235815555706`*^9, 3.8691236359804354`*^9}, {3.8691258186677256`*^9, 
   3.8691258442631435`*^9}, {3.869126061955866*^9, 3.869126065537384*^9}, 
   3.8691264527121286`*^9, {3.903158256851631*^9, 3.903158259009507*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"b2c7813d-add6-4262-a55e-e1d27f1d114a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqs", "[", "8", "]"}]], "Input",
 CellChangeTimes->{{3.869188644705087*^9, 3.869188675092515*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"ec3dfecb-4dfe-4807-b4f2-60108b06cce8"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.8691886500009212`*^9, 3.869188675607827*^9}, 
   3.8691907775137744`*^9, 3.869297319260702*^9, 3.8695455510280457`*^9, 
   3.8709171680301204`*^9, 3.8709176542483473`*^9, 3.903158263182259*^9, 
   3.903158315726904*^9, {3.903158379292164*^9, 3.903158406293998*^9}},
 CellLabel->"Out[40]=",ExpressionUUID->"5425fc4c-9ea4-4380-90ef-44cbbb76cbb3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"sol13", " ", "=", " ", 
  RowBox[{"sol", "[", "7", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "sol13", "]"}]}], "Input",
 CellChangeTimes->{{3.8691258500015965`*^9, 3.869125882627595*^9}, {
   3.8691259671128583`*^9, 3.8691259699717307`*^9}, 3.8691886786254377`*^9},
 CellLabel->"In[41]:=",ExpressionUUID->"3f9dc0bb-3606-4f7d-bb5f-31f51c9e4154"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    41, 1, 27196474232466593834, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9031584063560677`*^9},
 CellLabel->
  "During evaluation of \
In[41]:=",ExpressionUUID->"ccf3d738-fffa-4735-84c9-45373e5182e2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a1", "\[Rule]", "0"}], ",", 
    RowBox[{"a2", "\[Rule]", "1"}], ",", 
    RowBox[{"b2", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "2"}], "-", "b1"}]}], ",", 
    RowBox[{"b3", "\[Rule]", "0"}], ",", 
    RowBox[{"c1", "\[Rule]", "0"}], ",", 
    RowBox[{"c2", "\[Rule]", "1"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.869125857733266*^9, 3.869125889691182*^9, 3.8691259758903913`*^9, 
   3.869126325651682*^9, 3.869126466382023*^9, 3.869126930509881*^9, 
   3.869130989095655*^9, 3.869188639227312*^9, 3.8691886793082085`*^9, 
   3.869190779813877*^9, 3.8692973194029417`*^9, 3.869545552867586*^9, 
   3.870917168171412*^9, 3.8709176545782614`*^9, 3.903158265109043*^9, 
   3.9031583157481003`*^9, {3.903158379321069*^9, 3.903158406379786*^9}},
 CellLabel->"Out[41]=",ExpressionUUID->"46c47c53-85ec-4783-ad19-f6f169ced816"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.869125857733266*^9, 3.869125889691182*^9, 3.8691259758903913`*^9, 
   3.869126325651682*^9, 3.869126466382023*^9, 3.869126930509881*^9, 
   3.869130989095655*^9, 3.869188639227312*^9, 3.8691886793082085`*^9, 
   3.869190779813877*^9, 3.8692973194029417`*^9, 3.869545552867586*^9, 
   3.870917168171412*^9, 3.8709176545782614`*^9, 3.903158265109043*^9, 
   3.9031583157481003`*^9, {3.903158379321069*^9, 3.903158406380927*^9}},
 CellLabel->"Out[42]=",ExpressionUUID->"c84a4479-b474-41e2-8f91-b7b9d54a7e79"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SS2cond13", " ", "=", " ", 
   RowBox[{
    RowBox[{"S2condd", " ", "/.", " ", 
     RowBox[{"sol13", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], " ", "//", " ", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"S2condd", " ", "=", " ", "SS2cond13"}]}], "Input",
 CellChangeTimes->{{3.8691259994224925`*^9, 3.86912603001573*^9}, {
  3.8691264740534835`*^9, 3.869126479794145*^9}, {3.903158270209124*^9, 
  3.9031582715241957`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"9f535de2-0348-4c21-a684-a14d296f2f79"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "4"}], "+", "e1"}], ")"}], " ", "k2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "-", 
       RowBox[{"u", "[", 
        RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "]"}]}], ")"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"4", "+", "f1"}], ")"}], " ", "k3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "-", 
       RowBox[{"u", "[", 
        RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "]"}]}], ")"}]}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "2"}], 
      "]"}]}], "+", 
    RowBox[{"e1", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "2"}], 
      "]"}]}], "+", 
    RowBox[{"8", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "2"}], 
      "]"}]}], "-", 
    RowBox[{"2", " ", "e1", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "2"}], 
      "]"}]}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "2"}], 
      "]"}]}], "+", 
    RowBox[{"e1", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "2"}], 
      "]"}]}], "-", 
    RowBox[{"e1", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "1", ",", "2", ",", "1", ",", "2", ",", "2"}], 
      "]"}]}], "-", 
    RowBox[{"f1", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "1", ",", "2", ",", "1", ",", "2", ",", "2"}], 
      "]"}]}], "-", 
    RowBox[{"e1", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "1", ",", "2", ",", "2", ",", "1", ",", "2"}], 
      "]"}]}], "-", 
    RowBox[{"f1", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "1", ",", "2", ",", "2", ",", "1", ",", "2"}], 
      "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "1", ",", "2", ",", "2", ",", "2", ",", "2"}], 
      "]"}]}], "+", 
    RowBox[{"f1", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "1", ",", "2", ",", "2", ",", "2", ",", "2"}], 
      "]"}]}], "+", 
    RowBox[{"2", " ", "e1", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "2", ",", "1", ",", "2", ",", "1", ",", "2"}], 
      "]"}]}], "+", 
    RowBox[{"2", " ", "f1", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "2", ",", "1", ",", "2", ",", "1", ",", "2"}], 
      "]"}]}], "-", 
    RowBox[{"8", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "2", ",", "1", ",", "2", ",", "2", ",", "2"}], 
      "]"}]}], "-", 
    RowBox[{"2", " ", "f1", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "2", ",", "1", ",", "2", ",", "2", ",", "2"}], 
      "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "2", ",", "2", ",", "1", ",", "2", ",", "2"}], 
      "]"}]}], "+", 
    RowBox[{"f1", " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "2", ",", "2", ",", "1", ",", "2", ",", "2"}], 
      "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "4"}], "+", "e1"}], ")"}], " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "2", ",", "2"}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "4"}], "+", "e1"}], ")"}], " ", 
     RowBox[{"u", "[", 
      RowBox[{"1", ",", "1", ",", "2", ",", "1", ",", "2"}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"4", "+", "f1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"1", ",", "1", ",", "2", ",", "2", ",", "2"}], "]"}], "-", 
       RowBox[{"u", "[", 
        RowBox[{"1", ",", "2", ",", "1", ",", "2", ",", "2"}], "]"}]}], 
      ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8691260091105204`*^9, 3.8691260308071127`*^9}, 
   3.8691263291051455`*^9, {3.869126469522648*^9, 3.869126480723152*^9}, 
   3.869126930951445*^9, 3.8691309932532735`*^9, 3.8691886860704627`*^9, 
   3.869190782413094*^9, 3.86929731962912*^9, 3.869545562415598*^9, 
   3.8709171683162575`*^9, 3.870917654746829*^9, {3.90315826763265*^9, 
   3.9031582718305798`*^9}, 3.9031583158673277`*^9, {3.9031583794404383`*^9, 
   3.903158406414307*^9}},
 CellLabel->"Out[44]=",ExpressionUUID->"7bcb4f9f-e464-48f5-9316-15c4fc1aeddf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"sol12", " ", "=", " ", 
  RowBox[{"sol", "[", "6", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "sol12", "]"}]}], "Input",
 CellChangeTimes->{{3.869125860668833*^9, 3.869125863117841*^9}, {
   3.8691260351918125`*^9, 3.869126042750492*^9}, 3.869188689676886*^9},
 CellLabel->"In[45]:=",ExpressionUUID->"357726a4-41a6-40de-9cd8-cafd6fc0c63c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"e1", "\[Rule]", "4"}], ",", 
    RowBox[{"f1", "\[Rule]", 
     RowBox[{"-", "4"}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.869125878552326*^9, {3.869126045592885*^9, 3.869126073805812*^9}, 
   3.8691263336147485`*^9, 3.8691264904719677`*^9, 3.8691269323490944`*^9, 
   3.8691309969186325`*^9, 3.8691886902970276`*^9, 3.869190791812756*^9, 
   3.8692973197444*^9, 3.86954556630896*^9, 3.8709171684937553`*^9, 
   3.8709176548258605`*^9, 3.9031582748928947`*^9, 3.9031583158735437`*^9, {
   3.9031583794467916`*^9, 3.9031584064216957`*^9}},
 CellLabel->"Out[45]=",ExpressionUUID->"23b8cd6a-e003-4d8d-b0c7-5c9acc483bd0"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.869125878552326*^9, {3.869126045592885*^9, 3.869126073805812*^9}, 
   3.8691263336147485`*^9, 3.8691264904719677`*^9, 3.8691269323490944`*^9, 
   3.8691309969186325`*^9, 3.8691886902970276`*^9, 3.869190791812756*^9, 
   3.8692973197444*^9, 3.86954556630896*^9, 3.8709171684937553`*^9, 
   3.8709176548258605`*^9, 3.9031582748928947`*^9, 3.9031583158735437`*^9, {
   3.9031583794467916`*^9, 3.903158406422823*^9}},
 CellLabel->"Out[46]=",ExpressionUUID->"211b742d-bc2d-43ff-8c70-dc79daf09884"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SS2cond12", " ", "=", " ", 
   RowBox[{
    RowBox[{"S2condd", " ", "/.", " ", 
     RowBox[{"sol12", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], " ", "//", " ", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"S2condd", " ", "=", " ", "SS2cond12"}]}], "Input",
 CellChangeTimes->{{3.8691264976137123`*^9, 3.869126502581994*^9}, {
  3.8691908157096424`*^9, 3.8691908173296394`*^9}, {3.9031582782619762`*^9, 
  3.9031582813721123`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"6b22b38c-a038-4c19-854b-2225a5cfb165"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.869126503150807*^9, 3.869126932658338*^9, 3.869131000398185*^9, 
   3.8691886932547874`*^9, {3.869190794559311*^9, 3.8691908176400533`*^9}, 
   3.8692973198691387`*^9, 3.8695455688424635`*^9, 3.870917168619794*^9, 
   3.8709176549023542`*^9, 3.903158281769918*^9, 3.9031583158945208`*^9, {
   3.9031583794693537`*^9, 3.903158406448077*^9}},
 CellLabel->"Out[48]=",ExpressionUUID->"ae922559-6ebf-439d-9ff0-6d12e8b645ae"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"final", " ", "S2"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9031582836005297`*^9, 3.903158288389481*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"14e33f7a-b736-42ee-aea3-b993cfb4d149"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fS2", " ", "=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"S2", " ", "/.", " ", 
       RowBox[{"sol13", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", "/.", " ", 
      RowBox[{"sol12", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], " ", "//", " ", "Expand"}], ",", " ",
     "z"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.869126657147518*^9, 3.8691267058353567`*^9}, 
   3.8691908417894897`*^9, 3.8692973322954245`*^9},
 CellLabel->"In[50]:=",ExpressionUUID->"a5ae1f6b-2e6d-4482-aef3-5f409cc99d98"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["k3", "2"], " ", 
   RowBox[{"u", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "-", 
  RowBox[{"2", " ", "k2", " ", "k3", " ", 
   RowBox[{"u", "[", 
    RowBox[{"1", ",", "2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["k2", "2"], " ", 
   RowBox[{"u", "[", 
    RowBox[{"2", ",", "2"}], "]"}]}], "+", 
  RowBox[{"2", " ", "k3", " ", 
   RowBox[{"u", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "]"}]}], "-", 
  RowBox[{"d1", " ", 
   RowBox[{"u", "[", 
    RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}]}], "-", 
  RowBox[{"2", " ", "k2", " ", 
   RowBox[{"u", "[", 
    RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}]}], "-", 
  RowBox[{"2", " ", "k3", " ", 
   RowBox[{"u", "[", 
    RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}]}], "+", 
  RowBox[{"d1", " ", 
   RowBox[{"u", "[", 
    RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["z", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", 
      RowBox[{"u", "[", 
       RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}]}], "-", 
     RowBox[{"g1", " ", 
      RowBox[{"u", "[", 
       RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}]}], "+", 
     RowBox[{"g1", " ", 
      RowBox[{"u", "[", 
       RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"2", " ", "k2", " ", 
   RowBox[{"u", "[", 
    RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "]"}]}], "+", 
  RowBox[{"z", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", "k3", " ", 
      RowBox[{"u", "[", 
       RowBox[{"1", ",", "1", ",", "2"}], "]"}]}], "-", 
     RowBox[{"4", " ", "k2", " ", 
      RowBox[{"u", "[", 
       RowBox[{"1", ",", "2", ",", "2"}], "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"u", "[", 
       RowBox[{"1", ",", "1", ",", "2", ",", "1", ",", "2"}], "]"}]}], "-", 
     RowBox[{"4", " ", 
      RowBox[{"u", "[", 
       RowBox[{"1", ",", "2", ",", "1", ",", "2", ",", "2"}], "]"}]}]}], 
    ")"}]}], "+", 
  RowBox[{"u", "[", 
   RowBox[{"1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "2"}], "]"}], 
  "+", 
  RowBox[{"b1", " ", 
   RowBox[{"u", "[", 
    RowBox[{"1", ",", "1", ",", "2", ",", "1", ",", "2", ",", "2"}], "]"}]}], 
  "-", 
  RowBox[{"2", " ", 
   RowBox[{"u", "[", 
    RowBox[{"1", ",", "1", ",", "2", ",", "2", ",", "1", ",", "2"}], "]"}]}], 
  "-", 
  RowBox[{"b1", " ", 
   RowBox[{"u", "[", 
    RowBox[{"1", ",", "1", ",", "2", ",", "2", ",", "1", ",", "2"}], "]"}]}], 
  "+", 
  RowBox[{"u", "[", 
   RowBox[{"1", ",", "2", ",", "2", ",", "1", ",", "2", ",", "2"}], 
   "]"}]}]], "Output",
 CellChangeTimes->{
  3.8691266578643074`*^9, {3.8691266895543337`*^9, 3.86912670639796*^9}, 
   3.8691269362037263`*^9, 3.869131039186813*^9, 3.869190842477547*^9, {
   3.8692973200515594`*^9, 3.8692973328404474`*^9}, 3.8695455713145933`*^9, 
   3.8709171688088894`*^9, 3.8709176549813128`*^9, {3.903158293242115*^9, 
   3.90315831592008*^9}, {3.9031583794943647`*^9, 3.9031584064760647`*^9}},
 CellLabel->"Out[50]=",ExpressionUUID->"6e90cd6f-b039-45b8-8553-970c05c098b5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", "verification", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9031582958301697`*^9, 3.903158300398756*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"1e0794c7-c977-42dd-bdec-4020c1d37b36"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"canon", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", 
     RowBox[{
      RowBox[{"fS2", " ", "/.", " ", 
       RowBox[{"z", " ", "\[Rule]", " ", "t"}]}], ",", " ", "eq"}], "]"}], 
    " ", "/.", " ", 
    RowBox[{"t", " ", "\[Rule]", " ", "z"}]}], "//", " ", "Expand"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8691267781139193`*^9, 3.869126844747892*^9}, 
   3.869190848117015*^9, 3.903158391668232*^9},
 CellLabel->"In[52]:=",ExpressionUUID->"1e2a52b0-5e6a-4e79-af68-64dfe6a166f5"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8691268248543015`*^9, 3.86912684930626*^9}, 
   3.8691269401799917`*^9, 3.869131052639838*^9, 3.8691908486337605`*^9, {
   3.8692973202939916`*^9, 3.8692973348089027`*^9}, 3.8695455741966352`*^9, 
   3.8709171689321513`*^9, 3.8709176550583687`*^9, {3.903158302572439*^9, 
   3.903158315940186*^9}, {3.903158379520514*^9, 3.9031584065034933`*^9}},
 CellLabel->"Out[52]=",ExpressionUUID->"d46d09b0-9050-44c4-ba37-2fe3cef0baa4"]
}, Open  ]]
},
WindowSize->{1475, 821},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"35c48798-1b3f-474d-b9ae-c74a377081c1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 327, 7, 30, "Input",ExpressionUUID->"0a2a61d5-a80b-4c1e-858f-54772ab64b7c"],
Cell[888, 29, 6609, 196, 556, "Input",ExpressionUUID->"f3ea4bdc-d937-4796-9655-ef9c1d4cf11c"],
Cell[7500, 227, 364, 7, 30, "Input",ExpressionUUID->"dda56fcf-c2a6-49a7-aca3-db7497f171c8"],
Cell[7867, 236, 914, 21, 30, "Input",ExpressionUUID->"bcb32108-e4cc-44a8-b475-e61782159cb0"],
Cell[8784, 259, 274, 5, 30, "Input",ExpressionUUID->"6ad73000-3869-4a7d-aea1-86afc89e4388"],
Cell[9061, 266, 1142, 32, 52, "Input",ExpressionUUID->"63fa9b80-1b94-4301-91a8-114380b1f451"],
Cell[10206, 300, 638, 15, 30, "Input",ExpressionUUID->"f0291f1b-87b4-4fc9-93f9-e37cdba700d1"],
Cell[CellGroupData[{
Cell[10869, 319, 644, 15, 52, "Input",ExpressionUUID->"7e1e2e46-66f8-4df6-8940-7824e3e0dbfd"],
Cell[11516, 336, 757, 11, 34, "Output",ExpressionUUID->"4ae1bcad-2f21-4449-ade8-869a1faf2822"]
}, Open  ]],
Cell[12288, 350, 527, 13, 30, "Input",ExpressionUUID->"8424e404-2b9d-4f51-99e1-c7737976e911"],
Cell[12818, 365, 5251, 137, 136, "Input",ExpressionUUID->"dc440fc4-555e-424b-9ba9-31172769df75"],
Cell[18072, 504, 391, 7, 30, "Input",ExpressionUUID->"d8d75281-56df-4f85-becd-34a68ebb7560"],
Cell[18466, 513, 1514, 39, 94, "Input",ExpressionUUID->"e0bae1e6-d102-46b8-a1b4-17bded858e06"],
Cell[19983, 554, 276, 5, 30, "Input",ExpressionUUID->"0bee7e23-c418-4976-8a75-6c8178cc8dc1"],
Cell[20262, 561, 1937, 51, 94, "Input",ExpressionUUID->"b2c7813d-add6-4262-a55e-e1d27f1d114a"],
Cell[CellGroupData[{
Cell[22224, 616, 201, 3, 30, "Input",ExpressionUUID->"ec3dfecb-4dfe-4807-b4f2-60108b06cce8"],
Cell[22428, 621, 412, 6, 34, "Output",ExpressionUUID->"5425fc4c-9ea4-4380-90ef-44cbbb76cbb3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22877, 632, 384, 6, 52, "Input",ExpressionUUID->"3f9dc0bb-3606-4f7d-bb5f-31f51c9e4154"],
Cell[23264, 640, 361, 9, 28, "Message",ExpressionUUID->"ccf3d738-fffa-4735-84c9-45373e5182e2"],
Cell[23628, 651, 908, 19, 34, "Output",ExpressionUUID->"46c47c53-85ec-4783-ad19-f6f169ced816"],
Cell[24539, 672, 558, 8, 34, "Output",ExpressionUUID->"c84a4479-b474-41e2-8f91-b7b9d54a7e79"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25134, 685, 558, 12, 52, "Input",ExpressionUUID->"9f535de2-0348-4c21-a684-a14d296f2f79"],
Cell[25695, 699, 4667, 126, 98, "Output",ExpressionUUID->"7bcb4f9f-e464-48f5-9316-15c4fc1aeddf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30399, 830, 378, 6, 52, "Input",ExpressionUUID->"357726a4-41a6-40de-9cd8-cafd6fc0c63c"],
Cell[30780, 838, 701, 14, 34, "Output",ExpressionUUID->"23b8cd6a-e003-4d8d-b0c7-5c9acc483bd0"],
Cell[31484, 854, 545, 8, 34, "Output",ExpressionUUID->"211b742d-bc2d-43ff-8c70-dc79daf09884"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32066, 867, 563, 12, 52, "Input",ExpressionUUID->"6b22b38c-a038-4c19-854b-2225a5cfb165"],
Cell[32632, 881, 527, 9, 34, "Output",ExpressionUUID->"ae922559-6ebf-439d-9ff0-6d12e8b645ae"]
}, Open  ]],
Cell[33174, 893, 236, 4, 30, "Input",ExpressionUUID->"14e33f7a-b736-42ee-aea3-b993cfb4d149"],
Cell[CellGroupData[{
Cell[33435, 901, 575, 14, 30, "Input",ExpressionUUID->"a5ae1f6b-2e6d-4482-aef3-5f409cc99d98"],
Cell[34013, 917, 3120, 84, 77, "Output",ExpressionUUID->"6e90cd6f-b039-45b8-8553-970c05c098b5"]
}, Open  ]],
Cell[37148, 1004, 219, 3, 30, "Input",ExpressionUUID->"1e0794c7-c977-42dd-bdec-4020c1d37b36"],
Cell[CellGroupData[{
Cell[37392, 1011, 517, 13, 30, "Input",ExpressionUUID->"1e2a52b0-5e6a-4e79-af68-64dfe6a166f5"],
Cell[37912, 1026, 476, 6, 57, "Output",ExpressionUUID->"d46d09b0-9050-44c4-ba37-2fe3cef0baa4"]
}, Open  ]]
}
]
*)

